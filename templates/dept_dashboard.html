<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} | Ortho_Psy Tech</title>
    
    <style>
        :root {
            --brand-bg: #2c3e50;
            --gold: #f1c40f;
            --accent-blue: #3498db;
            --bg-gray: #f4f7f6;
            --white: #ffffff;
            --danger: #e74c3c;
            --success: #27ae60;
        }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background-color: var(--bg-gray); margin: 0; display: flex; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© - Ù…Ø·Ø§Ø¨Ù‚Ø© ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ù„Ù…Ø±Ø¬Ø¹ */
        .admin-sidebar { width: 250px; background: var(--brand-bg); height: 100vh; color: white; padding: 20px; position: fixed; right: 0; top: 0; z-index: 1000; }
        .admin-sidebar h3 { color: var(--gold); text-align: center; border-bottom: 1px solid #444; padding-bottom: 15px; }
        .menu-item { padding: 15px; cursor: pointer; border-radius: 8px; margin-bottom: 10px; transition: 0.3s; display: flex; align-items: center; gap: 10px; }
        .menu-item.active { background: var(--accent-blue); }
        
        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content { margin-right: 250px; width: calc(100% - 250px); padding: 30px; }
        
        /* Ø§Ù„ÙƒØ±ÙˆØª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© */
        .header-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-right: 5px solid var(--accent-blue); }
        .stat-card h4 { margin: 0; color: #666; font-size: 0.9rem; }
        .stat-card p { margin: 10px 0 0; font-size: 1.8rem; font-weight: bold; color: var(--brand-bg); }
        
        /* Ø§Ù„Ø£Ù„ÙˆØ§Ø­ */
        .control-panel { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 30px; }
        
        /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
        .table-container { overflow-x: auto; margin-top: 15px; }
        table { width: 100%; border-collapse: collapse; text-align: right; }
        th { background: #f8f9fa; color: var(--brand-bg); padding: 12px; border-bottom: 2px solid #eee; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 0.95rem; }
        
        /* Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ© */
        .tool-form { display: grid; grid-template-columns: 2fr 3fr auto; gap: 10px; margin-bottom: 20px; background: #f9f9f9; padding: 15px; border-radius: 10px; }
        .tool-input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 0.9rem; }
        .btn-add { background: var(--success); color: white; border: none; padding: 10px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-delete { background: none; border: none; color: var(--danger); cursor: pointer; font-weight: bold; font-size: 1.2rem; }
        .tool-link { color: var(--accent-blue); text-decoration: none; font-weight: bold; }

        @media (max-width: 768px) {
            .admin-sidebar { width: 70px; padding: 10px; }
            .admin-sidebar h3, .menu-item span { display: none; }
            .main-content { margin-right: 70px; width: calc(100% - 70px); }
            .tool-form { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="admin-sidebar">
        <h3>{{ title.split(' ')[1] }}</h3> <div class="menu-item active">ğŸ  Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª</div>
        <a href="/login" style="color: #ff7675; text-decoration: none; margin-top: 50px; display: block; text-align: center; font-weight: bold;">ğŸšª Ø®Ø±ÙˆØ¬</a>
    </div>

    <div class="main-content">
        <div class="header-stats">
            <div class="stat-card"><h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¯ÙˆØ§Øª</h4><p>{{ tools|length }}</p></div>
            <div class="stat-card" style="border-right-color: #3498db;"><h4>Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h4><p>{{ tools|selectattr('category', 'equalto', 'ØªÙ‚ÙŠÙŠÙ…')|list|length }}</p></div>
            <div class="stat-card" style="border-right-color: #9b59b6;"><h4>Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ´Ø®ÙŠØµ</h4><p>{{ tools|selectattr('category', 'equalto', 'ØªØ´Ø®ÙŠØµ')|list|length }}</p></div>
            <div class="stat-card" style="border-right-color: #27ae60;"><h4>Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ£Ù‡ÙŠÙ„</h4><p>{{ tools|selectattr('category', 'equalto', 'ØªØ£Ù‡ÙŠÙ„')|list|length }}</p></div>
        </div>

        <div class="control-panel">
            <h3>ğŸ“Š Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h3>
            <div class="tool-form">
                <input type="text" id="name_eval" class="tool-input" placeholder="Ø§Ø³Ù… Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…">
                <input type="text" id="url_eval" class="tool-input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø¯Ø§Ø©">
                <button onclick="addTool('eval', 'ØªÙ‚ÙŠÙŠÙ…')" class="btn-add">+ Ø¥Ø¶Ø§ÙØ©</button>
            </div>
            <div class="table-container">
                <table>
                    <thead><tr><th>Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©</th><th>Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
                    <tbody>
                        {% for tool in tools if tool.category == 'ØªÙ‚ÙŠÙŠÙ…' %}
                        <tr>
                            <td><strong>{{ tool.name }}</strong></td>
                            <td><a href="{{ tool.url }}" target="_blank" class="tool-link">ÙØªØ­ Ø§Ù„Ø£Ø¯Ø§Ø© ğŸ”—</a></td>
                            <td><button class="btn-delete" onclick="deleteTool('{{ tool.id }}')">Ã—</button></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="control-panel">
            <h3>ğŸ” Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ´Ø®ÙŠØµ</h3>
            <div class="tool-form">
                <input type="text" id="name_diag" class="tool-input" placeholder="Ø§Ø³Ù… Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ´Ø®ÙŠØµ">
                <input type="text" id="url_diag" class="tool-input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø¯Ø§Ø©">
                <button onclick="addTool('diag', 'ØªØ´Ø®ÙŠØµ')" class="btn-add">+ Ø¥Ø¶Ø§ÙØ©</button>
            </div>
            <div class="table-container">
                <table>
                    <thead><tr><th>Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©</th><th>Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
                    <tbody>
                        {% for tool in tools if tool.category == 'ØªØ´Ø®ÙŠØµ' %}
                        <tr>
                            <td><strong>{{ tool.name }}</strong></td>
                            <td><a href="{{ tool.url }}" target="_blank" class="tool-link">ÙØªØ­ Ø§Ù„Ø£Ø¯Ø§Ø© ğŸ”—</a></td>
                            <td><button class="btn-delete" onclick="deleteTool('{{ tool.id }}')">Ã—</button></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="control-panel">
            <h3>ğŸ› ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ£Ù‡ÙŠÙ„ ÙˆØ§Ù„Ø¹Ù„Ø§Ø¬</h3>
            <div class="tool-form">
                <input type="text" id="name_rehab" class="tool-input" placeholder="Ø§Ø³Ù… Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ£Ù‡ÙŠÙ„">
                <input type="text" id="url_rehab" class="tool-input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø¯Ø§Ø©">
                <button onclick="addTool('rehab', 'ØªØ£Ù‡ÙŠÙ„')" class="btn-add">+ Ø¥Ø¶Ø§ÙØ©</button>
            </div>
            <div class="table-container">
                <table>
                    <thead><tr><th>Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©</th><th>Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
                    <tbody>
                        {% for tool in tools if tool.category == 'ØªØ£Ù‡ÙŠÙ„' %}
                        <tr>
                            <td><strong>{{ tool.name }}</strong></td>
                            <td><a href="{{ tool.url }}" target="_blank" class="tool-link">ÙØªØ­ Ø§Ù„Ø£Ø¯Ø§Ø© ğŸ”—</a></td>
                            <td><button class="btn-delete" onclick="deleteTool('{{ tool.id }}')">Ã—</button></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        function addTool(prefix, categoryName) {
            const name = document.getElementById('name_' + prefix).value;
            const url = document.getElementById('url_' + prefix).value;
            if(!name || !url) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

            let formData = new FormData();
            formData.append('tool_name', name);
            formData.append('tool_url', url);
            formData.append('tool_category', categoryName);

            fetch('{{ post_url }}', { method: 'POST', body: formData })
            .then(r => r.ok ? location.reload() : alert("ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸"))
            .catch(() => alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±"));
        }

        function deleteTool(toolId) {
            if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø©ØŸ')) {
                fetch('{{ delete_url }}/' + toolId, { method: 'POST' })
                .then(r => r.ok ? location.reload() : alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù"));
            }
        }
    </script>
</body>
    </html>
